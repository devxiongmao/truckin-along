<div id="initiate-modal" class="modal hidden" data-controller="pre-delivery-inspection">
  <div class="modal-content">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
      <h3>Pre-Delivery Inspection Checklist</h3>
      <% if Rails.env.development? %>
      <button type="button" class="btn btn-warning btn-sm" id="check-all-dev" style="background-color: #ffc107; border-color: #ffc107; color: #000;">
        ✓ Check All (DEV)
      </button>
      <% end %>
    </div>

    <form id="initiate-form" method="post" data-action="submit->modal#submitForm">
      <p>Before initiating delivery, please confirm all safety checks:</p>

      <div class="inspection-section">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
          <h4>Exterior Inspection</h4>
          <% unless Rails.env.development? %>
          <button type="button" class="btn btn-outline-secondary btn-sm section-check-all" data-section="exterior">
            ✓ Check Section
          </button>
          <% end %>
        </div>

        <div class="checklist-group exterior-checks">
          <h5>1. General Condition</h5>
          <label>
            <input type="checkbox" name="truck_body" required>
            Truck body free of visible damage or defects
          </label>
          <label>
            <input type="checkbox" name="trailer_body" required>
            Trailer body free of visible damage or defects
          </label>
          <label>
            <input type="checkbox" name="license_plates" required>
            License plates visible, clean, and securely attached
          </label>
        </div>

        <div class="checklist-group exterior-checks">
          <h5>2. Lights and Reflectors</h5>
          <label>
            <input type="checkbox" name="headlights" required>
            Headlights (low and high beam) operational
          </label>
          <label>
            <input type="checkbox" name="turn_signals" required>
            Turn signals (front and rear) operational
          </label>
          <label>
            <input type="checkbox" name="brake_lights" required>
            Brake lights operational
          </label>
          <label>
            <input type="checkbox" name="reverse_lights" required>
            Reverse lights operational
          </label>
          <label>
            <input type="checkbox" name="clearance_lights" required>
            Clearance lights and reflectors clean and functional
          </label>
          <label>
            <input type="checkbox" name="hazard_lights" required>
            Hazard lights operational
          </label>
        </div>

        <div class="checklist-group exterior-checks">
          <h5>3. Tires and Wheels</h5>
          <label>
            <input type="checkbox" name="tread_depth" required>
            Adequate tread depth (minimum 4/32" for steer tires, 2/32" for others)
          </label>
          <label>
            <input type="checkbox" name="tire_inflation" required>
            Proper tire inflation (check PSI levels)
          </label>
          <label>
            <input type="checkbox" name="tire_damage" required>
            No cuts, bulges, or visible damage
          </label>
          <label>
            <input type="checkbox" name="lug_nuts" required>
            Lug nuts secure, no rust streaks indicating looseness
          </label>
          <label>
            <input type="checkbox" name="wheels" required>
            Wheels free of cracks or dents
          </label>
        </div>

        <div class="checklist-group exterior-checks">
          <h5>4. Windshield and Mirrors</h5>
          <label>
            <input type="checkbox" name="windshield" required>
            Windshield clean and free of cracks or chips
          </label>
          <label>
            <input type="checkbox" name="wipers" required>
            Wipers operational, with clean and intact blades
          </label>
          <label>
            <input type="checkbox" name="mirrors" required>
            Mirrors properly adjusted, clean, and intact
          </label>
        </div>

        <div class="checklist-group exterior-checks">
          <h5>5. Fluid Leaks</h5>
          <label>
            <input type="checkbox" name="fluid_leaks" required>
            No visible leaks under the truck or trailer
          </label>
        </div>

        <div class="checklist-group exterior-checks">
          <h5>6. Coupling Devices</h5>
          <label>
            <input type="checkbox" name="trailer_hitch" required>
            Trailer hitch secure and operational
          </label>
          <label>
            <input type="checkbox" name="safety_chains" required>
            Safety chains attached and in good condition
          </label>
          <label>
            <input type="checkbox" name="electrical_connections" required>
            Electrical connections secure and functional
          </label>
          <label>
            <input type="checkbox" name="air_lines" required>
            Air lines connected and free of leaks
          </label>
        </div>
      </div>

      <div class="inspection-section">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
          <h4>Interior Inspection</h4>
          <% unless Rails.env.development? %>
          <button type="button" class="btn btn-outline-secondary btn-sm section-check-all" data-section="interior">
            ✓ Check Section
          </button>
          <% end %>
        </div>

        <div class="checklist-group interior-checks">
          <h5>1. Brakes</h5>
          <label>
            <input type="checkbox" name="service_brake" required>
            Service brake operational
          </label>
          <label>
            <input type="checkbox" name="parking_brake" required>
            Parking brake holds the vehicle securely
          </label>
          <label>
            <input type="checkbox" name="trailer_brakes" required>
            Trailer brakes operational (if applicable)
          </label>
        </div>

        <div class="checklist-group interior-checks">
          <h5>2. Steering</h5>
          <label>
            <input type="checkbox" name="steering" required>
            Steering wheel operates smoothly with no excessive play
          </label>
        </div>

        <div class="checklist-group interior-checks">
          <h5>3. Gauges and Indicators</h5>
          <label>
            <input type="checkbox" name="fuel_gauge" required>
            Fuel gauge operational
          </label>
          <label>
            <input type="checkbox" name="oil_pressure" required>
            Oil pressure gauge operational
          </label>
          <label>
            <input type="checkbox" name="coolant_temp" required>
            Coolant temperature gauge operational
          </label>
          <label>
            <input type="checkbox" name="air_pressure" required>
            Air pressure gauge operational (for air brakes)
          </label>
        </div>

        <div class="checklist-group interior-checks">
          <h5>4. Horn and Warning Devices</h5>
          <label>
            <input type="checkbox" name="horn" required>
            Horn operational
          </label>
          <label>
            <input type="checkbox" name="backup_alarm" required>
            Back-up alarm operational (if equipped)
          </label>
        </div>

        <div class="checklist-group interior-checks">
          <h5>5. Emergency Equipment</h5>
          <label>
            <input type="checkbox" name="fire_extinguisher" required>
            Fire extinguisher present and fully charged
          </label>
          <label>
            <input type="checkbox" name="spare_fuses" required>
            Spare fuses or circuit breakers available
          </label>
          <label>
            <input type="checkbox" name="reflective_triangles" required>
            Reflective triangles or road flares present
          </label>
        </div>
      </div>

      <div class="inspection-section">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
          <h4>Trailer-Specific Checks</h4>
          <% unless Rails.env.development? %>
          <button type="button" class="btn btn-outline-secondary btn-sm section-check-all" data-section="trailer">
            ✓ Check Section
          </button>
          <% end %>
        </div>

        <div class="checklist-group trailer-checks">
          <h5>1. Trailer Doors</h5>
          <label>
            <input type="checkbox" name="trailer_doors" required>
            Doors and latches secure and operational
          </label>
          <label>
            <input type="checkbox" name="seals" required>
            Seals intact to prevent leakage of cargo
          </label>
        </div>

        <div class="checklist-group trailer-checks">
          <h5>2. Cargo Securement</h5>
          <label>
            <input type="checkbox" name="cargo_loaded" required>
            Cargo properly loaded and secured
          </label>
          <label>
            <input type="checkbox" name="load_balanced" required>
            Load balanced to prevent shifting during transit
          </label>
        </div>
      </div>

      <div class="inspection-section">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
          <h4>Additional Checks</h4>
          <% unless Rails.env.development? %>
          <button type="button" class="btn btn-outline-secondary btn-sm section-check-all" data-section="additional">
            ✓ Check Section
          </button>
          <% end %>
        </div>

        <div class="checklist-group additional-checks">
          <h5>1. Exhaust System</h5>
          <label>
            <input type="checkbox" name="exhaust" required>
            No visible damage, leaks, or excessive noise
          </label>
        </div>

        <div class="checklist-group additional-checks">
          <h5>2. Suspension System</h5>
          <label>
            <input type="checkbox" name="suspension" required>
            No broken, damaged, or missing components
          </label>
        </div>

        <div class="checklist-group additional-checks">
          <h5>3. Documentation</h5>
          <label>
            <input type="checkbox" name="registration" required>
            Vehicle registration and insurance on board
          </label>
          <label>
            <input type="checkbox" name="inspection_docs" required>
            Inspection documentation on board
          </label>
        </div>
      </div>

      <!-- Hidden field for truck_id -->
      <input type="hidden" name="truck_id" id="modal-truck-id">

      <div class="form-actions">
        <label class="confirm-all">
          <input type="checkbox" id="confirm-all" name="confirm_all" required>
          <strong>I confirm all items have been checked and the vehicle is safe for delivery</strong>
        </label>

        <div class="modal-buttons">
          <button type="button" class="btn btn-secondary" data-action="modal#close">Cancel</button>
          <button type="submit" class="btn btn-primary">Confirm & Start Delivery</button>
        </div>
      </div>
    </form>
  </div>
</div>